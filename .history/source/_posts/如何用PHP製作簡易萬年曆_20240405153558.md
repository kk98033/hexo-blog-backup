---
title: 如何用PHP製作簡易萬年曆
date: 2024-04-05 15:20:21
tags:
  - PHP
  - 網站開發
categories:
  - 學習筆記
---
# 如何用PHP製作簡易萬年曆

最近因緣際會需要在網頁上製作一個萬年曆，最好是要可以超級簡單且非常好背的版本，最後決定直接用 PHP 做，想說順便分享一下我的作法。接下來本文將帶領大家使用PHP，來製作一個簡易的萬年曆！

## 環境準備
首先，你需要有一個能運行 PHP 的環境。這可以是任何安裝了 PHP 的伺服器，或者是像 XAMPP、 MAMP 這樣的本地開發環境。另外要確保你的PHP版本至少是 5.6 以上（當然，最好使用新版本）。

如果你不打算使用 XAMPP 之類的方式來架設 PHP 伺服器，你可以參考我之前的文章——[使用VSCode實現PHP server和Live Server的即時開發](https://blog.iddle.dev/public/2024/04/04/%E4%BD%BF%E7%94%A8VSCode%E5%AF%A6%E7%8F%BEPHP-server%E5%92%8CLive-Server%E7%9A%84%E5%8D%B3%E6%99%82%E9%96%8B%E7%99%BC/)，在本地端 VScode 架設一個可以即時刷新的 PHP 開發環境 :D

## 步驟一：設置時區
為了確保時間的準確性，首先要設置正確的時區。在這裏，我們將時區設定為'Asia/Taipei'，這樣可以確保萬年曆中顯示的時間是準確的。

```php
<?php
date_default_timezone_set('Asia/Taipei');
?>
```

## 步驟二：處理年份和月份
接下來，我們需要獲取當前的年份和月份，使用它來展示當前月份的日歷。這裡我使用 `GET` 的方式，如果 URL 中有提供，使用 URL 中的年份和月份；否則，默認使用當前的年份和月份。

```php
$year = isset($_GET['year']) ? $_GET['year'] : date('Y');
$month = isset($_GET['month']) ? $_GET['month'] : date('m');
```

## 步驟三：計算前後月份的年份和月份
為了能夠瀏覽前一個月和下一個月的萬年曆，我們需要計算前後月份的年份和月份。

這裡先簡單介紹一下這裡會用到的函式

#### mktime 函式
`mktime()` 是 PHP 中的一個函式，用於**獲取 Unix 時間戳(timestamp)****。Unix 時間戳(timestamp)是指自1970年1月1日（即Unix紀元）以來的秒數。這個函式的一般格式如下：

```php
mktime(hour, minute, second, month, day, year)
```

#### date 函式
date() 函式用於**格式化 Unix 時間戳(timestamp)**，將其轉換為可讀的日期和時間格式。其語法如下：

```php
date(format, timestamp)
```
format: 日期和時間的格式。
timestamp: **可填可不填**。指定的 Unix 時間戳(timestamp)。**如果省略，將使用當前的日期和時間**。

計算前後月份的年份和月份程式碼：
```php
$prevMonth = date('m', mktime(0, 0, 0, $month - 1, 1, $year));
$prevYear = date('Y', mktime(0, 0, 0, $month - 1, 1, $year));
$nextMonth = date('m', mktime(0, 0, 0, $month + 1, 1, $year));
$nextYear = date('Y', mktime(0, 0, 0, $month + 1, 1, $year));
```
這段程式碼首先利用 `mktime()` 函式生成特定日期的 Unix 時間戳(timestamp)。
對於前一個月（$prevMonth 和 $prevYear），它將當前月份減 1（$month - 1）。
對於下一個月（$nextMonth 和 $nextYear），則將當前月份加 1（$month + 1）。
日期（日）設定為 1，讓時間戳**指向目標月份的第一天。時、分、秒都設為 0**。

然後，date() 函式根據這些時間戳**格式化出具體的年份和月份**。
對於月份（$prevMonth 和 $nextMonth），格式設定為 `'m'`，這將返回格式化為兩位數的月份（01 到 12）。
對於年份（$prevYear 和 $nextYear），格式設定為 `'Y'`，這將返回四位數的年份（例如 2023）。

通過這種方式，即使當前是一月或十二月，計算也能正確跨年處理，因為 mktime() 會自動調整日期，使其成為有效值。例如，如果當前月份是 1 月，$month - 1 會變成 0，mktime() 會自動將其解讀為上一年的 12 月。同樣的，如果當前月份是 12 月，$month + 1 會變成 13，mktime() 會將其解讀為下一年的 1 月。這樣就實現了無縫的年份和月份跨越。:)
